# 极大似然估计(maximum likelihood estimation)

## 举个例子
在学校中我们想进行一个男生与女生的身高调查，根据经验可知身高符合正态分布，以下仅讨论男生的情况，设我们抽取了$N$个男生每个男生的身高为$x_i, i=1,2,...,N$用$X$表示抽取的全体样本那么就有$X$服从分布$N(\mu,\sigma^2)$，那么问题就来了从前我们是根据**分布情况**来推断这些男生的身高的概率，现在我们得到了男生的身高结果要反推$N(\mu,\sigma^2)$再具体一点就是我们要知道$\mu$和$\sigma^2$即正态分布的两个参数  
## 极大似然估计  
为了解决上述问题，我们就可以使用极大似然估计，所谓极大似然估计就是用**已知的结果**来反推数据分布的**参数**，*注意*必须是确定的分布(例如：正态分布，二项分布，泊松分布等)才能用这种方法。  
接下来我们就来用极大似然估计来求解一下$\mu$和$\sigma^2$
首先正态分布的概率质量函数为：
$$
f(x|\mu,\sigma^2)=\frac{1}{\sqrt{2\pi\sigma^2}}e^{-\frac{(x_i-\mu)^2}{2\sigma^2}}
$$
然后再回到我们的样本我们随机抽了N个学生而这些学生是满足独立同分布的那么抽到这N个学生的概率即：  
$$
L(\theta)=\prod_{i=1}^{N}p(x_i,\theta)
$$
以这个例子来说**似然函数**从形式上来说就是一堆概率的联合概率，而式子中的$x_i$是确定的量$\theta$是变量。思考有那么多学生我们为什么一抽就抽到了这N个人呢？因为在原来参数为$\theta$的分布下这件事情的概率最大嘛，因此我们最大化$L(\theta)$就可以得到原来分布的参数估计了。  
但是连乘的形式非常难操作所以取一下对数则
$$
H(\theta)=logL(\theta)=\sum_{i=1}^{N}logp(x_i|\theta)
$$
再带入正态分布，我们的完整式子为：
$$
H(\mu,\sigma^2)=\sum_{i=1}^{N}log{\frac{1}{\sqrt{2\pi\sigma^2}}e^{-\frac{(x_i-\mu)^2}{2\sigma^2}}}
$$
我们先求$\mu$函数H对$\mu$求偏导另结果等于0得：
$$
\frac{\partial}{\partial\mu}\sum_{i=1}^{N}(log{\frac{1}{\sqrt{2\pi}}}+log{\frac{1}{\sigma}}-\frac{(x_i-\mu)^2}{2\sigma^2})=\sum_{i=1}^{N}2(x_i-\mu)(-1)=0
$$
$$
\sum_{i=1}^{N}x_i-\sum_{i=1}^{N}\mu=0
$$
$$
\mu_{MLE}=\frac{1}{N}\sum_{i=1}^{N}x_i
$$
我们再求$\sigma$函数H对$\sigma$求偏导另结果等于0得：
$$
\frac{\partial}{\partial\sigma}\sum_{i=1}^{N}(log{\frac{1}{\sqrt{2\pi}}}+log{\frac{1}{\sigma}}-\frac{(x_i-\mu)^2}{2\sigma^2})=\sum_{i=1}^{N}[-\frac{1}{\sigma}-\frac{1}{2}(x_i-\mu)^2(-2\sigma^{-3})]=0
$$
$$
\sum_{i=1}^{N}\sigma^2=\sum_{i=1}^{N}(x_i-\mu)
$$
$$
\sigma^2=\frac{1}{N}\sum_{i=1}^{N}(x_i-\mu_{MLE})
$$
由此我们就可以得到男生身高所服从的正态分布的两个参数从而获得完整的男生身高分布即:
$$
N(\frac{1}{N}\sum_{i=1}^{N}x_i,\frac{1}{N}\sum_{i=1}^{N}(x_i-\mu_{MLE})
$$
生活中的许多得知结果反推分布的问题都可以这样解决，最后强调一点极大似然估计**一定要在已知确定的的分布**下开展。
## 总结  
用极大似然算法估计参数的一般步骤  
1. 写出似然函数；
2. 对似然函数取对数，并整理；
3. 求导数，令导数为0，得到似然方程；
4. 解似然方程，得到的参数即为所求；

## 参考
1. [CSDN-如何通俗理解EM算法](https://blog.csdn.net/v_july_v/article/details/81708386)
2. [BiliBili-机器学习-白板推导系列(二)-数学基础](https://www.bilibili.com/video/av32905863)